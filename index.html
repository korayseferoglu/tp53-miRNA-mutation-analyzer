<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TP53 3′‑UTR Mutation & miRNA Analysis Tool</title>
<style>
 body{font-family:Arial,Helvetica,sans-serif;max-width:900px;margin:auto;padding:24px}
 h1{font-size:22px;margin-bottom:12px}
 textarea{width:100%;height:160px;font-family:monospace;font-size:14px}
 button{margin-top:12px;padding:8px 18px;font-size:15px;cursor:pointer}
 table{border-collapse:collapse;margin-top:18px;width:100%}
 th,td{border:1px solid #666;padding:4px 6px;text-align:center;font-size:13px}
 th{background:#eee}
 .err{color:#c00;font-weight:bold;margin-top:12px}
</style>
</head>
<body>

<h1>TP53 3′‑UTR Mutation & miRNA Analysis Tool</h1>

<p>Paste the patient’s TP53 3′‑UTR sequence below (A T G C only; line breaks are fine) ⤵︎</p>
<textarea id="seqInput" placeholder="Example: ATGCT..."></textarea>
<br>
<button id="analyzeBtn">Analyze</button>

<div id="output"></div>

<script>
// ——————————————— Constants ———————————————
const REF_SEQ = `CATTCTCCACTTCTTGTTCCCCACTGACAGCCTCCCACCCCCATCTCTCCCTCCCCTGCCATTTTGGGTTTTGGGTCTTTGAACCCTTGCTTGCAATAGGTGTGCGTCAGAAGCACCCAGGACTTCCATTTGCTTTGTCCCGGGGCTCCACTGAACAAGTTGGCCTGCACTGGTGTTTTGTTGTGGGGAGGAGGATGGGGAGTAGGACATACCAGCTTAGATTTTAAGGTTTTTACTGTGAGGGATGTTTGGGAGATGTAAGAAATGTTCTTGCAGTTAAGGGTTAGTTTACAATCAGCCACATTCTAGGTAGGGGCCCACTTCACCGTACTAACCAGGGAAGCTGTCCCTCACTGTTGAATTTTCTCTAACTTCAAGGCCCATATCTGTGAAATGCTGGCATTTGCACCTACCTCACAGAGTGCATTGTGAGGGTTAATGAAATAATGTACATCTGGCCTTGAAACCACCTTTTATTACATGGGGTCTAGAACTTGACCCCCTTGAGGGTGCTTGTTCCCTCTCCCTGTTGGTCGGTGGGTTGGTAGTTTCTACAGTTGGGCAGCTGGTTAGGTAGAGGGAGTTGTCAAGTCTCTGCTGGCCCAGCCAAACCCTGTCTGACAACCTCTTGGTGAACCTTAGTACCTAAAAGGAAATCTCACCCCATCCCACACCCTGGAGGATTTCATCTCTTGTATATGATGATCTGGATCCACCAAGACTTGTTTTATGCTCAGGGTCAATTTCTTTTTTCTTTTTTTTTTTTTTTTTTCTTTTTCTTTGAGACTGGGTCTCGCTTTGTTGCCCAGGCTGGAGTGGAGTGGCGTGATCTTGGCTTACTGCAGCCTTTGCCTCCCCGGCTCGAGCAGTCCTGCCTCAGCCTCCGGAGTAGCTGGGACCACAGGTTCATGCCACCATGGCCAGCCAACTTTTGCATGTTTTGTAGAGATGGGGTCTCACAGTGTTGCCCAGGCTGGTCTCAAACTCCTGGGCTCAGGCGATCCACCTGTCTCAGCCTCCCAGAGTGCTGGGATTACAATTGTGAGCCACCACGTCCAGCTGGAAGGGTCAACATCTTTTACATTCTGCAAGCACATCTGCATTTTCACCCCACCCTTCCCCTCCTTCTCCCTTTTTATATCCCATTTTTATATCGATCTCTTATTTTACAATAAAACTTTGCTGCCA`;

const MIRNA_CSV = `hsa-miR-642a-5p	576-582	0.427	0.6	0.1	0.2818181818181818	0.00722018
hsa-miR-6891-5p	1121-1127	0.582	0.7	0.5	0.26999999999999996	0.05499900
hsa-let-7d-5p	410-416	0.5	0.6	0.001	0.16363636363636364	0.00004909
hsa-let-7b-3p	693-699	0.458	0.7	0.01	0.17709090909090908	0.00056775
hsa-miR-29b-2-5p	463-469	0.533	0.6	0.1	0.1909090909090909	0.00610527
hsa-miR-10401-5p	668-674	0.589	0.7	0.5	0.19454545454545452	0.04010555
hsa-miR-10527-5p	129-135	0.456	0.7	0.1	0.1781818181818182	0.00568756
hsa-miR-12114	1002-1008	0.551	0.7	0.5	0.04745454545454547	0.00915161
hsa-miR-12118	1121-1127	0.447	0.7	0.5	0.36727272727272725	0.05745982
hsa-miR-21-3p	171-177	0.464	1.0	+1.5	0.1181818181818182	0.08225455
hsa-miR-485-5p	28-34	0.56	1.0	0.01	0.1272727272727273	0.00071273
hsa-miR-485-5p	878-884	0.56	1.0	0.01	0.09636363636363637	0.00053964
hsa-miR-485-5p	1013-1019	0.56	1.0	0.01	0.1527272727272727	0.00085527
hsa-miR-520b-5p	942-948	0.458	0.7	0.1	0.08	0.00256480
hsa-miR-519a-2-5p	942-948	0.458	0.7	1.0	0.08	0.02564800
hsa-miR-508-5p	811-817	0.469	0.7	0.1	0.2232727272727273	0.00733004
hsa-miR-612	803-809	0.742	1.0	0.01	0.24454545454545454	0.00181453
hsa-miR-612	966-972	0.742	1.0	0.01	0.24672727272727274	0.00183072
hsa-miR-876-3p	465-471	0.589	0.7	0.1	0.17272727272727273	0.00712155
hsa-miR-665	985-991	0.658	0.85	1.0	0.10054545454545455	0.05623507
hsa-miR-922	594-600	0.416	0.7	0.01	0.22909090909090907	0.00066711
hsa-miR-1285-3p	803-809	0.909	1.0	1.0	0.24454545454545454	0.22229182
hsa-miR-1285-3p	966-972	0.909	1.0	1.0	0.24672727272727274	0.22427509
hsa-miR-1294	412-418	0.433	0.7	0.01	0.12910909090909092	0.00039133
hsa-miR-1247-3p	138-144	0.513	0.7	1.0	0.21563636363636365	0.07743502
hsa-miR-1249-5p	48-54	0.653	1.0	1.0	0.409090909090909	0.26713636
hsa-miR-1825	167-173	0.493	0.7	0.5	0.26345454545454544	0.04545908
hsa-miR-3126-5p	346-352	0.5	0.7	0.01	0.18000000000000002	0.00063000
hsa-miR-3190-5p	918-924	0.476	0.7	0.5	0.24	0.03998400
hsa-miR-3192-5p	1017-1023	0.767	0.7	0.5	0.20636363636363633	0.05539832
hsa-miR-4319	733-739	0.393	0.7	0.01	0.17054545454545453	0.00046917
hsa-miR-4271	1116-1122	0.536	0.7	0.1	0.14727272727272725	0.00552567
hsa-miR-3667-5p	73-79	0.48	0.7	0.5	0.18618181818181814	0.03127855
hsa-miR-3689a-3p	31-37	0.584	0.7	0.1	0.0890909090909091	0.00364204
hsa-miR-3689a-3p	1016-1022	0.584	0.7	0.1	0.20636363636363633	0.00843615
hsa-miR-3689b-3p	31-37	0.511	0.7	0.5	0.0890909090909091	0.01593391
hsa-miR-3689b-3p	1016-1022	0.584	0.7	0.5	0.20636363636363633	0.04218073
hsa-miR-4433a-3p	984-990	0.613	0.7	0.5	0.09454545454545456	0.02028473
hsa-miR-4458	410-416	0.504	0.7	0.1	0.16363636363636364	0.00577309
hsa-miR-4474-3p	297-303	0.609	0.7	1.0	0.1781818181818182	0.07595891
hsa-miR-4478	877-883	0.491	0.85 	0.5	0.09272727272727274	0.01934986
hsa-miR-4478	1012-1018	0.476	0.85 	0.5	0.14927272727272728	0.03019787
hsa-miR-3689c	31-37	0.584	0.7	0.5	0.0890909090909091	0.01821018
hsa-miR-3689c	1016-1022	0.584	0.7	0.5	0.20636363636363633	0.04218073
hsa-miR-4505	602-608	0.571	0.7	1.0	0.1618181818181818	0.06467873
hsa-miR-4677-3p	414-420	0.427	0.7	0.1	0.1709090909090909	0.00510847
hsa-miR-4677-3p	956-962	0.427	0.7	0.1	0.20854545454545453	0.00623342
hsa-miR-4725-5p	735-741	0.549	0.7	0.1	0.12181818181818184	0.00468147
hsa-miR-4747-5p	1115-1121	0.533	0.7	0.5	0.15818181818181817	0.02950882
hsa-miR-4769-5p	666-672	0.589	0.7	1.0	0.1909090909090909	0.07871182
hsa-miR-5193 	188-194	0.518	0.6	0.5	0.14363636363636362	0.02232109
hsa-miR-5196-3p	191-197	0.529	0.7	0.5	0.17272727272727273	0.03198045
hsa-miR-4524b-3p	613-619	0.431	0.7	0.5	0.06181818181818183	0.00932527
hsa-miR-4524b-3p	1006-1012	0.431	0.7	0.5	0.09090909090909091	0.01371364
hsa-miR-5587-3p	139-145	0.542	0.7	0.1	0.25436363636363635	0.00965056
hsa-miR-5703	1125-1131	0.52	0.7	1.0	0.3563636363636363	0.12971636
hsa-miR-5787	602-608	0.813	0.7	0.1	0.1618181818181818	0.00920907
hsa-miR-1199-5p	991-997	0.624	0.7	0.5	0.1938181818181818	0.04232989
hsa-miR-6078	994-1000	0.464	0.7	0.5	0.1290909090909091	0.02096436
hsa-miR-6086	622-628	0.589	0.7	0.1	0.35454545454545455	0.01461791
hsa-miR-6732-5p	498-504	0.696	0.7	0.5	0.26345454545454544	0.06417753
hsa-miR-6742-5p	1108-1114	0.582	0.7	0.1	0.31236363636363634	0.01272569
hsa-miR-6751-5p	37-43	0.636	0.7	0.1	0.5654545454545453	0.02517404
hsa-miR-6773-5p	314-320	0.604	0.7	0.5	0.18727272727272726	0.03958945
hsa-miR-6778-5p	32-38	0.642	0.85	1.0	0.1509090909090909	0.08235109
hsa-miR-6785-5p	49-55	0.584	0.7	0.1	0.4763636363636363	0.01947375
hsa-miR-6808-5p	871-877	0.649	0.7	0.5	0.26909090909090905	0.06112400
hsa-miR-6811-5p	163-169	0.464	0.7	0.5	0.20727272727272728	0.03366109
hsa-miR-6819-5p	660-666	0.6	1.0	0.5	0.22181818181818183	0.06654545
hsa-miR-6819-5p	1107-1113	0.6	1.0	0.5	0.3327272727272727	0.09981818
hsa-miR-6834-5p	347-353	0.549	0.7	0.1	0.1690909090909091	0.00649816
hsa-miR-6838-3p	118-124	0.513	0.7	0.5	0.1890909090909091	0.03395127
hsa-miR-6840-3p	986-992	0.584	0.7	0.1	0.13818181818181816	0.00564887
hsa-miR-6883-5p	49-55	0.524	0.7	0.1	0.4763636363636363	0.01747302
hsa-miR-6884-5p	28-34	0.529	0.7	0.1	0.1272727272727273	0.00471291
hsa-miR-6884-5p	878-884	0.529	0.7	0.1	0.09636363636363637	0.00356835
hsa-miR-6884-5p	1013-1019	0.611	0.7	0.1	0.1527272727272727	0.00653215
hsa-miR-7150	55-61	0.624	0.7	1.0	0.4218181818181818	0.18425018
hsa-miR-1273h-5p	31-37	0.776	0.7	0.1	0.0890909090909091	0.00483942
hsa-miR-1273h-5p	1016-1022	0.776	0.7	0.1	0.20636363636363633	0.01120967
hsa-miR-7849-3p	1037-1043	0.404	0.7	0.5	0.020000000000000018	0.00282800
hsa-miR-9986	412-418	0.493	0.7	0.5	0.12910909090909092	0.02227777`;

// ——————————————— Helper functions ———————————————
const cleanSeq = s => s.toUpperCase().replace(/[^ATGC]/g,'');
const parseMirnaCsv = csv => csv.trim().split(/\r?\n/)
  .map(line=>{
    const [miRNA,pos,B,F,P,C,miRES] = line.trim().split(/\s+/);
    const [start,end] = pos.split('-').map(Number);
    return {miRNA,start,end,B:+B,F:+F,P:+P,C:+C,miRES:+miRES};
});
const findMutations = (ref,sample)=>
  [...ref].flatMap((r,i)=>r!==sample[i]?{pos:i+1,ref:r,sam:sample[i]}:[]);

// ——————————————— Event ———————————————
document.getElementById('analyzeBtn').addEventListener('click',()=>{
  const sample = cleanSeq(document.getElementById('seqInput').value||'');
  const out = document.getElementById('output');
  out.innerHTML='';

  try{
    if(REF_SEQ.length!==sample.length)
      throw Error(`Length mismatch! Reference ${REF_SEQ.length}, sample ${sample.length}.`);

    const muts   = findMutations(REF_SEQ,sample); // [{pos,ref,sam},…]
    if(!muts.length){ out.textContent='No mutation detected.'; return; }

    const mirnas = parseMirnaCsv(MIRNA_CSV);
    const hits   = mirnas.filter(m =>
                    muts.some(mu => mu.pos>=m.start && mu.pos<=m.end));

    let html = `<p><strong>Detected mutation positions:</strong> ${muts.map(m=>m.pos).join(', ')}</p>`;
    if(!hits.length){
      html += '<p>No miRNAs overlap the mutation region.</p>';
    }else{
      html += `<table><thead><tr>
        <th>miRNA</th><th>Range</th><th>Position(s)</th><th>Base Change</th>
        <th>B</th><th>F</th><th>P</th><th>C</th><th>miRES</th>
      </tr></thead><tbody>`;
      hits.forEach(r=>{
        const localMuts = muts.filter(mu=>mu.pos>=r.start && mu.pos<=r.end);
        const posStr    = localMuts.map(mu=>mu.pos).join(', ');
        const changeStr = localMuts.map(mu=>`${mu.ref}→${mu.sam}`).join(', ');
        html += `<tr>
          <td>${r.miRNA}</td><td>${r.start}-${r.end}</td>
          <td>${posStr}</td><td>${changeStr}</td>
          <td>${r.B}</td><td>${r.F}</td><td>${r.P}</td><td>${r.C}</td><td>${r.miRES}</td>
        </tr>`;
      });
      html += '</tbody></table>';
    }
    out.innerHTML = html;

  }catch(err){
    out.innerHTML = `<p class="err">${err.message}</p>`;
  }
});
</script>
</b
